# 要件定義・画面一覧書 - RichmanManage

## 1. サービス概要

### 1.1 基本情報
- **サービス名**: RichmanManage（リッチマンマネージ）
- **ビジョン**: 不動産投資家が物件・借入・レントロールを一元管理し、データドリブンな経営判断を可能にする
- **ターゲット**: 
  - 主要: 法人化済み不動産投資家（物件3棟以上）
  - 副次: 個人投資家（将来の法人化予定者）

### 1.2 提供価値
1. **時間削減**: 月次収支計算の自動化（2日→30分）
2. **精度向上**: 手動計算ミスの排除
3. **意思決定支援**: リアルタイムKPIダッシュボード
4. **金融機関対応**: PDF出力による提出資料の簡素化

## 2. 機能要件

### 2.1 認証・ユーザー管理
- メールアドレス/パスワードによる認証
- 複数所有者（個人・法人）の切り替え
- パスワードリセット機能

### 2.2 物件管理
- 物件情報のCRUD操作
- 収支サマリーの自動計算
- 物件ごとのレントロール管理
- 関連借入の紐付け

### 2.3 借入管理
- 借入情報のCRUD操作
- 金利変更履歴の管理
- 返済スケジュール管理
- 残債の自動計算

### 2.4 レントロール管理
- 部屋単位の入居状況管理
- 家賃変更履歴
- 入退去履歴
- 空室率の自動計算

### 2.5 固定資産税管理
- 年度別の税額管理
- 四半期ごとの納付スケジュール
- 納付状況のステータス管理
- 支出一覧への自動連携

### 2.6 支出管理
- カテゴリ別の支出登録
- 月次/年次の集計
- 固定資産税との連携

### 2.7 キャッシュフロー分析
- 月次/年次の収支レポート
- グラフによる可視化
- 前年比較

### 2.8 PDF出力
- 物件一覧
- レントロール
- 収支レポート
- 銀行提出用フォーマット

### 2.9 AIデータインポート（新機能）
- 画像（固定資産税納税通知書等）のアップロード
- AIによる文字認識とデータ抽出
- 抽出結果の確認・編集
- データの自動反映（承認後）

## 3. 画面一覧

| # | 画面名 | パス | 主な機能 | 備考 |
|---|--------|------|----------|------|
| 1 | **ログイン** | `/login` | メール/パスワード認証、パスワードリセットリンク | Supabase Auth |
| 2 | **サインアップ** | `/signup` | 新規ユーザー登録、メール認証 | |
| 3 | **ダッシュボード** | `/` | 月次KPI表示（総収入/総支出/CF）、最近の取引履歴、クイックアクション | トップページ |
| 4 | **物件一覧** | `/properties` | 物件一覧表示、ソート/フィルター、新規追加ボタン | |
| 5 | **物件詳細** | `/properties/[id]` | 基本情報、収支サマリー、関連レントロール/借入リンク、編集/削除 | |
| 6 | **物件新規/編集** | `/properties/new`, `/properties/[id]/edit` | 物件情報入力フォーム | |
| 7 | **借入一覧** | `/loans` | 借入一覧表示、物件フィルター、新規追加ボタン | |
| 8 | **借入詳細** | `/loans/[id]` | 借入条件、金利変更履歴、返済履歴、編集/削除 | |
| 9 | **借入新規/編集** | `/loans/new`, `/loans/[id]/edit` | 借入情報入力フォーム | |
| 10 | **レントロール一覧** | `/rent-roll` | 全物件の部屋一覧、空室フィルター、入居率表示 | |
| 11 | **部屋詳細** | `/properties/[propertyId]/[roomId]` | 部屋情報、家賃履歴、入退去履歴、編集 | |
| 12 | **固定資産税一覧** | `/property-taxes` | 物件別税額、納付スケジュール、ステータス、新規追加 | |
| 13 | **固定資産税詳細** | `/property-taxes/[id]` | 評価額・税率、納付履歴、減免措置、納付登録 | |
| 14 | **支出一覧** | `/expenses` | 支出履歴、カテゴリフィルター、新規追加 | |
| 15 | **支出新規/編集** | `/expenses/new`, `/expenses/[id]/edit` | 支出情報入力フォーム | |
| 16 | **キャッシュフロー** | `/cash-flow` | 月次/年次切替、収支グラフ、詳細テーブル | |
| 17 | **PDF出力** | `/pdf-export` | 出力対象選択、期間指定、PDF生成 | |
| 18 | **AIデータインポート** | `/ai-import` | 画像アップロード、AI分析結果表示、データ確認・編集 | Supabase Edge Functions |
| 19 | **設定** | `/settings` | プロフィール編集、所有者管理、通知設定 | |

## 4. 非機能要件

### 4.1 パフォーマンス
- 初回表示: 3秒以内
- 画面遷移: 1秒以内
- API応答: 500ms以内

### 4.2 セキュリティ
- HTTPS通信必須
- Row Level Security実装
- 定期的なセキュリティ監査

### 4.3 可用性
- 稼働率: 99.9%以上
- 計画メンテナンス: 月1回以内

### 4.4 ユーザビリティ
- モバイルファースト設計
- 直感的なUI
- エラーメッセージの分かりやすさ

### 4.5 互換性
- ブラウザ: Chrome, Safari, Firefox, Edge（最新2バージョン）
- デバイス: スマートフォン、タブレット、PC

## 5. 制約事項

### 5.1 技術制約
- フロントエンド: Next.js 15 (App Router)
- バックエンド: Supabase
- デプロイ: Vercel

### 5.2 運用制約
- 初期リリースは日本語のみ
- 決済機能は次フェーズ

## 6. 用語定義

| 用語 | 説明 |
|------|------|
| 物件 | 投資対象の不動産（アパート、マンション等） |
| レントロール | 物件の部屋別賃貸状況一覧 |
| キャッシュフロー（CF） | 家賃収入から支出を引いた手取り金額 |
| 満室想定家賃 | 全室が入居した場合の想定家賃総額 |
| 固定資産税 | 不動産に課される地方税（年4回納付） |
| 所有者 | 物件の所有名義（個人または法人） |

## 7. 開発フェーズ

### Phase 1: MVP（3ヶ月）
- 基本的なCRUD機能
- ダッシュボード
- PDF出力（基本）

### Phase 2: 機能拡張（3ヶ月）
- 固定資産税管理
- 高度な分析機能
- AIデータインポート
- モバイルアプリ

### Phase 3: エンタープライズ（6ヶ月）
- API公開
- 税理士連携
- AI予測機能

