# Test info

- Name: Room Detail >> displays rent history correctly
- Location: /Users/tttela/Documents/Work/denof/works/250428richman-manage/dev/richman-manage/apps/web/e2e/room-detail.e2e.ts:49:7

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toBeVisible()

Locator: locator('text=家賃履歴')
Expected: visible
Received: <element(s) not found>
Call log:
  - expect.toBeVisible with timeout 5000ms
  - waiting for locator('text=家賃履歴')

    at /Users/tttela/Documents/Work/denof/works/250428richman-manage/dev/richman-manage/apps/web/e2e/room-detail.e2e.ts:53:45
```

# Page snapshot

```yaml
- alert
- button "Open Next.js Dev Tools":
  - img
- button "Open issues overlay": 1 Issue
- navigation:
  - button "previous" [disabled]:
    - img "previous"
  - text: 1/1
  - button "next" [disabled]:
    - img "next"
- img
- link "Next.js 15.3.1 (stale) Webpack":
  - /url: https://nextjs.org/docs/messages/version-staleness
  - img
  - text: Next.js 15.3.1 (stale) Webpack
- img
- dialog "Build Error":
  - text: Build Error
  - button "Copy Stack Trace":
    - img
  - link "Go to related documentation":
    - /url: https://nextjs.org/docs/messages/module-not-found
    - img
  - link "Learn more about enabling Node.js inspector for server code with Chrome DevTools":
    - /url: https://nextjs.org/docs/app/building-your-application/configuring/debugging#server-side-code
    - img
  - paragraph: "Module not found: Can't resolve '../../../components/layout/MainLayout'"
  - img
  - text: ./src/app/properties/[propertyId]/[roomId]/page.tsx (9:1)
  - button "Open in editor":
    - img
  - text: "Module not found: Can't resolve '../../../components/layout/MainLayout' 7 | import { Button } from '@/components/ui/button'; 8 | import { ArrowLeft, Home, Calendar, DollarSign, User, Edit } from 'lucide-react'; > 9 | import MainLayout from '../../../components/layout/MainLayout'; | ^ 10 | import rentRollData from '../../../mock/rentRoll.json'; 11 | 12 | type UnitType = 'residence' | 'tenant' | 'parking' | 'vending' | 'solar';"
  - link "https://nextjs.org/docs/messages/module-not-found":
    - /url: https://nextjs.org/docs/messages/module-not-found
- contentinfo:
  - paragraph: This error occurred during the build process and can only be dismissed by fixing the error.
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 |
   3 | test.describe('Room Detail', () => {
   4 |   // モックデータから実際のIDを使用
   5 |   const propertyId = 'prop-001';
   6 |   const roomId = 'unit-001';
   7 |
   8 |   test('room detail page loads correctly', async ({ page }) => {
   9 |     await page.goto(`/properties/${propertyId}/${roomId}`);
  10 |     
  11 |     // ページタイトルの確認
  12 |     await expect(page.locator('h1')).toBeVisible();
  13 |     await expect(page.locator('h1')).toContainText('青山マンション');
  14 |     await expect(page.locator('h1')).toContainText('101');
  15 |     
  16 |     // ナビゲーションボタンの確認
  17 |     await expect(page.locator('text=物件詳細に戻る')).toBeVisible();
  18 |   });
  19 |
  20 |   test('displays room basic information correctly', async ({ page }) => {
  21 |     await page.goto(`/properties/${propertyId}/${roomId}`);
  22 |     
  23 |     // 基本情報カードの確認
  24 |     await expect(page.locator('text=基本情報')).toBeVisible();
  25 |     await expect(page.locator('text=部屋番号')).toBeVisible();
  26 |     await expect(page.locator('text=タイプ')).toBeVisible();
  27 |     await expect(page.locator('text=面積')).toBeVisible();
  28 |     await expect(page.locator('text=現在の家賃')).toBeVisible();
  29 |     
  30 |     // 実際の値の確認
  31 |     await expect(page.locator('text=101')).toBeVisible();
  32 |     await expect(page.locator('text=住居')).toBeVisible();
  33 |     await expect(page.locator('text=45.5㎡')).toBeVisible();
  34 |   });
  35 |
  36 |   test('displays contract information for occupied rooms', async ({ page }) => {
  37 |     await page.goto(`/properties/${propertyId}/${roomId}`);
  38 |     
  39 |     // 契約情報カードの確認（入居中の場合）
  40 |     await expect(page.locator('text=現在の契約情報')).toBeVisible();
  41 |     await expect(page.locator('text=入居者名')).toBeVisible();
  42 |     await expect(page.locator('text=契約開始日')).toBeVisible();
  43 |     await expect(page.locator('text=契約終了日')).toBeVisible();
  44 |     
  45 |     // 実際の入居者情報の確認
  46 |     await expect(page.locator('text=田中 太郎')).toBeVisible();
  47 |   });
  48 |
  49 |   test('displays rent history correctly', async ({ page }) => {
  50 |     await page.goto(`/properties/${propertyId}/${roomId}`);
  51 |     
  52 |     // 家賃履歴カードの確認
> 53 |     await expect(page.locator('text=家賃履歴')).toBeVisible();
     |                                             ^ Error: Timed out 5000ms waiting for expect(locator).toBeVisible()
  54 |     await expect(page.locator('text=契約開始')).toBeVisible();
  55 |     
  56 |     // 履歴エントリの確認
  57 |     const historyEntries = page.locator('[class*="border p-3"]');
  58 |     await expect(historyEntries).not.toHaveCount(0);
  59 |   });
  60 |
  61 |   test('displays lease history correctly', async ({ page }) => {
  62 |     await page.goto(`/properties/${propertyId}/${roomId}`);
  63 |     
  64 |     // 入退去履歴カードの確認
  65 |     await expect(page.locator('text=入退去履歴')).toBeVisible();
  66 |     
  67 |     // 履歴エントリの確認
  68 |     await expect(page.locator('text=田中 太郎')).toBeVisible();
  69 |     await expect(page.locator('text=入居中')).toBeVisible();
  70 |   });
  71 |
  72 |   test('can navigate back to property detail', async ({ page }) => {
  73 |     await page.goto(`/properties/${propertyId}/${roomId}`);
  74 |     
  75 |     // 戻るボタンをクリック
  76 |     await page.click('text=物件詳細に戻る');
  77 |     
  78 |     // 物件詳細ページに遷移することを確認
  79 |     await expect(page.url()).toBe(`http://localhost:3000/properties/${propertyId}`);
  80 |   });
  81 |
  82 |   test('action buttons are visible', async ({ page }) => {
  83 |     await page.goto(`/properties/${propertyId}/${roomId}`);
  84 |     
  85 |     // アクションボタンの確認
  86 |     await expect(page.locator('text=家賃変更')).toBeVisible();
  87 |     await expect(page.locator('text=入退去登録')).toBeVisible();
  88 |   });
  89 |
  90 |   test('handles invalid room id gracefully', async ({ page }) => {
  91 |     await page.goto(`/properties/${propertyId}/invalid-room-id`);
  92 |     
  93 |     // エラーメッセージの確認
  94 |     await expect(page.locator('text=部屋が見つかりません')).toBeVisible();
  95 |     await expect(page.locator('text=物件詳細に戻る')).toBeVisible();
  96 |   });
  97 | });
```